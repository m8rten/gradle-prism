apply plugin: 'groovy'
apply plugin: 'idea'
apply plugin: 'maven'
apply plugin: 'application'

dependencies {
    groovy localGroovy()
    compile 'com.yammer.dropwizard:dropwizard-core:0.6.1'
    compile 'org.mongojack:mongojack:2.0.0-RC5'
    compile 'com.sun.jersey:jersey-client:1.14'
    testCompile 'org.spockframework:spock-core:0.7-groovy-2.0@jar'
    testCompile group: 'junit', name: 'junit', version: '4.+'
}

mainClassName = "com.m8rten.gradle.prism.PrismService"

applicationDistribution.from(".") {
   include "prism.yml"
   into 'bin'
}

startScripts {
    doLast {
        unixScript.text = unixScript.text.replace(mainClassName, mainClassName + ' server prism.yml')
        windowsScript.text = windowsScript.text.replace(mainClassName, mainClassName + ' server prism.yml')
    }
}

class Spy implements BuildListener {

    @Override
    void buildFinished(BuildResult result){
        println "YOUOUO"
    }

    @Override void buildStarted(Gradle gradle){}

    @Override void projectsEvaluated(Gradle gradle){}

    @Override void projectsLoaded(Gradle gradle){}

    @Override void settingsEvaluated(Settings settings){}
}


gradle.addListener(new Spy())



